<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Water Tank Filling Tracker</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f4f7fa; }
    h1 { text-align: center; }
    .tank { border: 2px solid #ccc; padding: 15px; margin: 10px; border-radius: 10px; }
    .yellow { background: #fff8dc; }
    .white { background: #f8f8f8; }
    button { margin: 5px; padding: 8px 12px; border-radius: 6px; cursor: pointer; }
    table { border-collapse: collapse; width: 100%; margin-top: 15px; }
    th, td { border: 1px solid #999; padding: 8px; text-align: center; }
    th { background: #ddd; }
    .stats { margin-top: 20px; padding: 10px; border: 2px solid #999; border-radius: 10px; }
  </style>
</head>
<body>
  <h1>Water Tank Filling Tracker</h1>

  <div class="tank yellow">
    <h2>Yellow Tank (500 ml)</h2>
    <button onclick="startTimer('yellow500')">Start</button>
    <button onclick="stopTimer('yellow500')">Stop</button>
    <p id="yellow500-status">Status: Idle</p>
  </div>

  <div class="tank white">
    <h2>White Tank (1000 ml)</h2>
    <button onclick="startTimer('white1000')">Start</button>
    <button onclick="stopTimer('white1000')">Stop</button>
    <p id="white1000-status">Status: Idle</p>
  </div>

  <div class="tank yellow">
    <h2>Yellow Tank (1000 ml)</h2>
    <button onclick="startTimer('yellow1000')">Start</button>
    <button onclick="stopTimer('yellow1000')">Stop</button>
    <p id="yellow1000-status">Status: Idle</p>
  </div>

  <h2>Daily Records</h2>
  <table id="recordsTable">
    <thead>
      <tr>
        <th>Date</th>
        <th>Tank</th>
        <th>Duration (sec)</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="stats">
    <h2>Weekly & Monthly Statistics</h2>
    <p id="weeklyStats"></p>
    <p id="monthlyStats"></p>
  </div>

  <script>
    let startTimes = {};
    let records = JSON.parse(localStorage.getItem("tankRecords") || "[]");

    function saveRecords() {
      localStorage.setItem("tankRecords", JSON.stringify(records));
      renderTable();
      updateStats();
    }

    function startTimer(tank) {
      startTimes[tank] = Date.now();
      document.getElementById(tank+"-status").innerText = "Status: Running...";
    }

    function stopTimer(tank) {
      if (!startTimes[tank]) return;
      let duration = Math.floor((Date.now() - startTimes[tank]) / 1000);
      records.push({
        id: Date.now(),
        date: new Date().toLocaleDateString(),
        tank: tank,
        duration: duration
      });
      startTimes[tank] = null;
      document.getElementById(tank+"-status").innerText = "Status: Idle";
      saveRecords();
    }

    function renderTable() {
      let tbody = document.querySelector("#recordsTable tbody");
      tbody.innerHTML = "";
      records.forEach((rec, i) => {
        let row = `<tr>
          <td>${rec.date}</td>
          <td>${rec.tank}</td>
          <td>${rec.duration}</td>
          <td>
            <button onclick="editRecord(${rec.id})">Edit</button>
            <button onclick="deleteRecord(${rec.id})">Delete</button>
          </td>
        </tr>`;
        tbody.innerHTML += row;
      });
    }

    function editRecord(id) {
      let rec = records.find(r => r.id === id);
      let newDuration = prompt("Enter new duration (sec):", rec.duration);
      if (newDuration !== null) {
        rec.duration = parseInt(newDuration);
        saveRecords();
      }
    }

    function deleteRecord(id) {
      records = records.filter(r => r.id !== id);
      saveRecords();
    }

    function updateStats() {
      let now = new Date();
      let weekAgo = new Date(now); weekAgo.setDate(weekAgo.getDate() - 7);
      let monthAgo = new Date(now); monthAgo.setMonth(monthAgo.getMonth() - 1);

      let weekly = records.filter(r => new Date(r.date) >= weekAgo)
                          .reduce((a, r) => a + r.duration, 0);
      let monthly = records.filter(r => new Date(r.date) >= monthAgo)
                           .reduce((a, r) => a + r.duration, 0);

      document.getElementById("weeklyStats").innerText = "Weekly Total: " + weekly + " sec";
      document.getElementById("monthlyStats").innerText = "Monthly Total: " + monthly + " sec";
    }

    // Initial load
    renderTable();
    updateStats();
  </script>
</body>
</html>
